A股日内自动做T量化交易系统

项目概述

本项目是一套专为A股市场设计的日内自动做T量化交易系统，核心逻辑基于「底仓不动+日内滚动做T」策略，完美适配A股T+1交易规则。系统支持正T（先买后卖）、反T（先卖后买）两种做T模式，内置全维度风控体系，可实现半自动（信号推送+手动下单）和全自动（对接券商API自动下单）两种运行模式，兼顾新手安全性与资深用户效率。

系统采用模块化设计，严格解耦各功能模块，后续维护、扩展成本极低，可根据自身需求灵活调整策略参数、风控规则和交易标的。

核心优势

- 规则适配：严格匹配A股T+1规则，杜绝违规交易，仅对底仓之外的仓位进行日内滚动操作

- 风控全面：内置标的风控、信号风控、仓位风控、时间风控、大盘风控5大维度，一票否决制保障资金安全

- 模式灵活：支持半自动（推荐新手）和全自动两种模式，策略磨合稳定后可无缝切换

- 解耦易维护：按功能拆分模块，参数集中管理，改策略、改风控、改配置无需改动核心业务链路

- 闭环完整：从行情采集、信号生成、风控校验、交易执行到复盘分析，形成完整交易闭环，支持历史回测与实盘运行

- 安全可控：支持Ctrl+C手动安全停止，自动撤销未成交委托；收盘后自动复盘并退出，无需人工干预

技术栈

- 开发语言：Python 3.8+

- 核心依赖：pandas（数据处理）、numpy（数值计算）、talib（技术指标）、tushare（行情数据采集）

- 运行环境：Windows/macOS/Linux（需安装Python环境）

项目结构

AutoT_System/
├── config/                # 配置文件目录（所有参数集中管理）
│   └── settings.py        # 全局基础配置、策略参数、风控参数
├── core/                  # 核心业务模块目录（按功能解耦）
│   ├── data_collector.py  # 模块1：行情数据采集（实盘实时采集/回测历史采集）
│   ├── data_processor.py  # 模块2：数据清洗+技术指标计算
│   ├── strategy.py        # 模块3：做T策略信号生成（主策略+辅策略）
│   ├── risk_control.py    # 模块4：全维度风控校验（优先级最高）
│   ├── trade_executor.py  # 模块5：交易执行（半自动推送/全自动下单）
│   └── analysis.py        # 模块6：复盘分析+日志记录+绩效计算
├── utils/                 # 工具函数目录（通用功能复用）
│   └── common_utils.py    # 交易时间判断、安全撤单、日志打印等工具
├── main.py                # 项目唯一入口文件（一键启动，无业务逻辑）
├── data/                  # 数据存储目录（自动生成，存放历史行情数据）
├── log/                   # 日志存储目录（自动生成，存放交易日志）
└── README.md              # 项目说明&使用教程

快速上手（3步启动）

步骤1：环境准备

1. 安装Python 3.8+环境（推荐3.10版本），下载地址：https://www.python.org/downloads/

2. 安装依赖库：打开命令行，执行以下命令
        pip install pandas numpy talib tushare

3. 获取Tushare Token（行情数据采集必需）：
       

  - 注册Tushare账号：https://tushare.pro/register?reg=458143

  - 登录后进入「个人中心」→「接口Token」，复制你的Token

步骤2：配置项目

1. 配置Tushare Token：打开 core/data_collector.py，找到以下代码，替换为你的Token
        # Tushare Token 配置【必填，替换成你的】
ts.set_token("你的Tushare_Token_Here")
pro = ts.pro_api()

2. 修改核心参数：打开 config/settings.py，根据自身情况修改以下关键配置（其他参数默认即可）
        BASE_CONFIG = {
    "target_stock": "600000.SH",    # 做T标的股票代码（格式：60XXXX.SH/00XXXX.SZ）
    "base_position": 1000,          # 底仓持股数量（固定不变）
    "base_hold_cost": 10.00,        # 底仓持仓成本价（元）
    "current_cash": 100000.00,      # 可用资金（元）
    "trade_mode": "semi_auto",      # 交易模式：semi_auto(半自动)/full_auto(全自动)
    "holiday_list": ["20260101", "20260210", "20260405"]  # 法定节假日（手动补充）
}

步骤3：启动系统

1. 打开命令行，进入项目根目录（AutoT_System）

2. 执行启动命令：
        python main.py

3. 启动成功后，将显示以下信息，系统将自动判断交易时段并运行：
        ================================================================================
🚀 A股日内自动做T量化交易系统 - 已启动
📌 标的：600000.SH | 底仓：1000股 | 成本：10.00元
📌 可用资金：100000.0元 | 交易模式：semi_auto
📌 运行规则：仅交易时段9:30-11:30/13:00-15:00运行，Ctrl+C 安全停止
================================================================================

核心功能说明

1. 行情数据采集

- 实盘模式：独立线程实时采集1分钟K线和分时成交数据，每60秒更新一次，不阻塞主程序

- 回测模式：支持批量采集历史1分钟K线数据，存储到data目录，用于策略参数优化

2. 策略信号生成

- 主策略（80%信号来源）：布林带+RSI+量能震荡做T，核心逻辑：
        

  - 正T买入：股价触及布林带下轨+RSI≤30（超卖）+放量企稳

  - 正T卖出：股价触及布林带中轨+RSI≥60（超买）+缩量滞涨

  - 反T卖出：股价触及布林带上轨+RSI≥70（超买）+缩量滞涨

  - 反T买入：股价触及布林带中轨+RSI≤40（超卖）+放量企稳

- 辅策略（15%信号补充）：均线MA10+乖离率BIAS6趋势做T，补充主策略无信号场景

3. 全维度风控体系

风控优先级最高，采用一票否决制，所有规则全部通过才会生成有效交易信号：

- 标的风控：过滤换手率<3%、成交额<3亿的低流动性股票，禁止涨跌停附近交易

- 信号风控：确保交易数量为100股整数倍，过滤价差不足0.2%（无法覆盖手续费）的信号

- 仓位风控：日内总做T仓位≤底仓80%，买入前校验可用资金充足性

- 时间风控：14:30后只平仓不开新仓，规避尾盘波动风险

- 大盘风控：大盘涨跌幅≥2%时，禁止逆势开仓（大跌禁正T，大涨禁反T）

4. 交易执行模式

半自动模式（推荐新手）

- 系统仅推送交易信号到控制台和日志，需手动在券商软件完成下单

- 优势：保留人工判断，降低量化风险，适合策略磨合阶段，无券商API泄露风险

- 信号示例：
       ✅ 【做T信号推送】2026-01-10 10:30:00 | 标的：600000.SH | 模式：BUY_THEN_SELL | 方向：BUY | 价格：10.25 | 数量：500股 | 触发：BOLL下轨+RSI超卖+放量企稳

全自动模式（策略稳定后使用）

- 系统对接券商API自动完成限价委托下单，未成交自动撤单

- 配置方式：打开 core/trade_executor.py，替换send_order_to_broker函数中的模拟代码为你的券商API

- 注意：仅使用限价委托，杜绝市价委托，避免高滑点成本

5. 复盘分析

- 收盘后（15:05）自动生成复盘报告，包含做T次数、胜率、总盈亏、持仓成本降低幅度等核心指标

- 所有交易记录（成交/未成交/过滤信号）均归档到log/t_log.log，支持回溯审计

- 自动给出策略优化建议（如参数调整、频率控制等）

关键配置说明（config/settings.py）

1. 基础配置（BASE_CONFIG）

参数名

说明

默认值

target_stock

做T标的股票代码（上交所：60XXXX.SH，深交所：00XXXX.SZ）

600000.SH

base_position

底仓数量（固定不变，做T仅操作底仓之外的仓位）

1000

base_hold_cost

底仓持仓成本价（用于计算成本降低幅度）

10.00

current_cash

可用资金（元）

100000.00

trade_mode

交易模式：semi_auto（半自动）、full_auto（全自动）

semi_auto

market_risk_pct

大盘涨跌幅阈值，≥该值触发风控

0.02（2%）

avoid_end_trade

尾盘风控时间，该时间后只平仓不开新仓

1430（14:30）

holiday_list

法定节假日（格式：YYYYMMDD），需手动补充

["20260101", "20260210", "20260405"]

2. 策略参数（STRATEGY_CONFIG）

参数名

说明

默认值（最优参数）

t_position_ratio

单次做T仓位占底仓的比例

0.5（50%）

min_profit_pct

最小盈利阈值，需覆盖手续费

0.002（0.2%）

boll_timeperiod

布林带周期

20

rsi_timeperiod

RSI指标周期

6

3. 风控参数（RISK_CONFIG）

硬性规则，禁止随意修改，确保资金安全：

参数名

说明

默认值

max_t_position_ratio

日内总做T仓位上限（占底仓比例）

0.8（80%）

force_profit_pct

强制止盈阈值

0.0025（0.25%）

force_loss_pct

强制止损阈值

0.002（0.2%）

min_turnover

标的最小换手率要求

0.03（3%）

维护与扩展指南

1. 日常维护要点

- 定期补充config/settings.py中的节假日列表，避免非交易日误运行

- 查看log/t_log.log日志，监控系统运行状态和交易记录

- 策略运行一段时间后，根据复盘报告优化STRATEGY_CONFIG参数

- 确保Tushare账号有足够积分（基础行情需100积分，可通过完善资料/分享获取）

2. 功能扩展方法

添加新策略

1. 在core/strategy.py中新增策略函数（如gen_macd_signal），返回信号列表

2. 修改gen_all_signals函数，添加新策略的调用逻辑（如主策略无信号时调用新策略）

对接新券商API

1. 安装对应券商的API SDK（如东方财富、同花顺等）

2. 打开core/trade_executor.py，修改send_order_to_broker函数：
        

  - 替换模拟下单代码为券商API的下单接口

  - 替换撤单代码为券商API的撤单接口

新增风控规则

1. 在core/risk_control.py中新增风控函数（如check_volatility_risk），返回（是否通过，原因）

2. 修改risk_control函数，添加新增风控规则的校验逻辑

常见问题解决

1. 无法获取行情数据

- 检查Tushare Token是否正确配置，且账号有足够积分

- 检查网络连接，确保能正常访问Tushare官网

- 确认股票代码格式正确（如600000.SH而非600000）

2. 系统不生成交易信号

- 检查是否处于非交易时段（系统仅在9:30-11:30/13:00-15:00运行）

- 查看日志，确认是否因风控规则过滤（如换手率不足、大盘波动过大）

- 检查标的股票是否处于涨跌停状态，或流动性过低

3. 手动停止后无法重新启动

- 确认之前的程序进程已完全退出（Windows：任务管理器结束python进程；macOS/Linux：ps aux | grep python 后kill进程）

- 检查log目录下的日志文件是否被占用，关闭相关文件后重新启动

风险提示

1. 量化交易并非无风险，市场波动、策略失效等可能导致亏损，请谨慎使用，建议先用小资金磨合策略

2. 本系统仅提供交易信号和执行工具，不构成投资建议，所有交易决策由用户自行承担风险

3. 全自动模式需谨慎使用，确保券商API配置正确，避免因代码错误或网络问题导致异常交易

4. 做T核心原则：积小胜为大胜，严控仓位，不贪多，不重仓；手续费是做T天敌，优先保证胜率而非交易次数

联系方式

若有功能问题或优化建议，可通过以下方式反馈：

Email：your_email@example.com

GitHub：https://github.com/your-username/AutoT_System

最后更新时间：2026-01-10
